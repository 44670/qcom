From d2f91e4510578731a994c418e0fbe5445a1dbd5f Mon Sep 17 00:00:00 2001
From: shaomingliang <shaomingliang@meigsmart.com>
Date: Fri, 25 Nov 2016 15:10:57 +0800
Subject: [PATCH] [BugID]5119[SLM753_LM15][Description] LK add icn6202(i2c5) support [Solution]LK add icn6202 support

Change-Id: I10bef298796bb8e40504367d792a2194548220c2
---

diff --git a/bootable/bootloader/lk/app/aboot/aboot.c b/bootable/bootloader/lk/app/aboot/aboot.c
index a57e923..f50d053 100755
--- a/bootable/bootloader/lk/app/aboot/aboot.c
+++ b/bootable/bootloader/lk/app/aboot/aboot.c
@@ -57,6 +57,7 @@
 #include <boot_verifier.h>
 #include <image_verify.h>
 #include <decompress.h>
+#include <lvds.h>
 #if USE_RPMB_FOR_DEVINFO
 #include <rpmb.h>
 #endif
@@ -3083,7 +3084,9 @@
 
 	read_device_info(&device);
 	read_allow_oem_unlock(&device);
-
+	/*add by eliot shao 2016.11.25*/
+	/*resquest i2c5 and send cmds to icn6202 */
+	LVDS_Init();
 	/* Display splash screen if enabled */
 #if DISPLAY_SPLASH_SCREEN
 	dprintf(SPEW, "Display Init: Start\n");
diff --git a/bootable/bootloader/lk/dev/gcdb/display/include/panel_he070na_lvds_600p_video.h b/bootable/bootloader/lk/dev/gcdb/display/include/panel_he070na_lvds_600p_video.h
new file mode 100755
index 0000000..7c3c7e2
--- /dev/null
+++ b/bootable/bootloader/lk/dev/gcdb/display/include/panel_he070na_lvds_600p_video.h
@@ -0,0 +1,151 @@
+/* Copyright (c) 2013, The Linux Foundation. All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *  * Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ *  * Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *  * Neither the name of The Linux Foundation nor the names of its
+ *    contributors may be used to endorse or promote products derived
+ *    from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+ * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
+ * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
+ * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
+ * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
+ * OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
+ * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ */
+
+/*---------------------------------------------------------------------------
+ * This file is autogenerated file using gcdb parser. Please do not edit it.
+ * Update input XML file to add a new entry or update variable in this file
+ * VERSION = "1.0"
+ *---------------------------------------------------------------------------*/
+
+#ifndef _PANEL_HE070NA_LVDS_600P_VIDEO_H_
+#define _PANEL_HE070NA_LVDS_600P_VIDEO_H_
+/*---------------------------------------------------------------------------*/
+/* HEADER files                                                              */
+/*---------------------------------------------------------------------------*/
+#include "panel.h"
+
+/*---------------------------------------------------------------------------*/
+/* Panel configuration                                                       */
+/*---------------------------------------------------------------------------*/
+static struct panel_config he070na_lvds_600p_video_panel_data = {
+	"qcom,mdss_dsi_he070na_lvds_600p_video", "dsi:0:", "qcom,mdss-dsi-panel",
+	10, 0, "DISPLAY_1", 0, 0, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
+};
+
+/*---------------------------------------------------------------------------*/
+/* Panel resolution                                                          */
+/*---------------------------------------------------------------------------*/
+static struct panel_resolution he070na_lvds_600p_video_panel_res = {
+	1024, 600, 150, 150, 20, 0, 15, 15, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0
+};
+
+/*---------------------------------------------------------------------------*/
+/* Panel color information                                                   */
+/*---------------------------------------------------------------------------*/
+static struct color_info he070na_lvds_600p_video_color = {
+	24, 0, 0xff, 0, 0, 0
+};
+
+/*---------------------------------------------------------------------------*/
+/* Panel on/off command information                                          */
+/*---------------------------------------------------------------------------*/
+static char he070na_lvds_600p_video_on_cmd0[] = {
+	0x04, 0x00, 0x29, 0xC0,
+	0xB9, 0xFF, 0x83, 0x94,
+};
+
+static char he070na_lvds_600p_video_on_cmd1[] = {
+	0x29, 0x00, 0x05, 0x80
+};
+
+static struct mipi_dsi_cmd he070na_lvds_600p_video_on_command[] = {
+	{0x8, he070na_lvds_600p_video_on_cmd0, 0x00},
+	{0x4, he070na_lvds_600p_video_on_cmd1, 0x14}
+};
+
+#define HE070NA_LVDS_600P_VIDEO_ON_COMMAND 0
+
+
+static char he070na_lvds_600p_videooff_cmd0[] = {
+	0x28, 0x00, 0x05, 0x80
+};
+
+static char he070na_lvds_600p_videooff_cmd1[] = {
+	0x10, 0x00, 0x05, 0x80
+};
+
+static struct mipi_dsi_cmd he070na_lvds_600p_video_off_command[] = {
+	{0x4, he070na_lvds_600p_videooff_cmd0, 0x32},
+	{0x4, he070na_lvds_600p_videooff_cmd1, 0x78}
+};
+
+#define HE070NA_LVDS_600P_VIDEO_OFF_COMMAND 2
+
+
+static struct command_state he070na_lvds_600p_video_state = {
+	0, 1
+};
+
+/*---------------------------------------------------------------------------*/
+/* Command mode panel information                                            */
+/*---------------------------------------------------------------------------*/
+static struct commandpanel_info he070na_lvds_600p_video_command_panel = {
+	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
+};
+
+/*---------------------------------------------------------------------------*/
+/* Video mode panel information                                              */
+/*---------------------------------------------------------------------------*/
+static struct videopanel_info he070na_lvds_600p_video_video_panel = {
+	1, 0, 0, 0, 1, 1, 2, 0, 0x9
+};
+
+/*---------------------------------------------------------------------------*/
+/* Lane configuration                                                        */
+/*---------------------------------------------------------------------------*/
+static struct lane_configuration he070na_lvds_600p_video_lane_config = {
+	4, 0, 1, 1, 1, 1
+};
+
+/*---------------------------------------------------------------------------*/
+/* Panel timing                                                              */
+/*---------------------------------------------------------------------------*/
+static const uint32_t he070na_lvds_600p_video_timings[] = {
+	0x65, 0x12, 0x0C, 0x00, 0x34, 0x38, 0x10, 0x16, 0x0F, 0x03, 0x04, 0x00
+};
+
+static struct panel_timing he070na_lvds_600p_video_timing_info = {
+	0, 4, 0x05, 0x22
+};
+
+/*---------------------------------------------------------------------------*/
+/* Panel reset sequence                                                      */
+/*---------------------------------------------------------------------------*/
+static struct panel_reset_sequence he070na_lvds_600p_video_reset_seq = {
+	{1, 0, 1, }, {20, 2, 20, }, 2
+};
+
+/*---------------------------------------------------------------------------*/
+/* Backlight setting                                                         */
+/*---------------------------------------------------------------------------*/
+static struct backlight he070na_lvds_600p_video_backlight = {
+	1, 1, 255, 1, 0, "PMIC_8941"
+};
+
+#endif /*_PANEL_HE070NA_LVDS_600P_VIDEO_H_*/
diff --git a/bootable/bootloader/lk/platform/msm8916/acpuclock.c b/bootable/bootloader/lk/platform/msm8916/acpuclock.c
old mode 100644
new mode 100755
index c46dc60..4a559f8
--- a/bootable/bootloader/lk/platform/msm8916/acpuclock.c
+++ b/bootable/bootloader/lk/platform/msm8916/acpuclock.c
@@ -439,14 +439,14 @@
 	char clk_name[64];
 
 	struct clk *qup_clk;
-
+/*
 	if((blsp_id != BLSP_ID_1) || (qup_id != QUP_ID_1)) {
 		dprintf(CRITICAL, "Incorrect BLSP-%d or QUP-%d configuration\n", blsp_id, qup_id);
 		ASSERT(0);
 	}
-
-	snprintf(clk_name, sizeof(clk_name), "blsp1_qup2_ahb_iface_clk");
-
+*/
+	snprintf(clk_name, sizeof(clk_name), "blsp1_qup4_ahb_iface_clk");
+	
 	ret = clk_get_set_enable(clk_name, 0 , 1);
 
 	if (ret) {
@@ -454,7 +454,7 @@
 		return;
 	}
 
-	snprintf(clk_name, sizeof(clk_name), "gcc_blsp1_qup2_i2c_apps_clk");
+	snprintf(clk_name, sizeof(clk_name), "gcc_blsp1_qup4_i2c_apps_clk");
 
 	qup_clk = clk_get(clk_name);
 
diff --git a/bootable/bootloader/lk/platform/msm8916/gpio.c b/bootable/bootloader/lk/platform/msm8916/gpio.c
old mode 100644
new mode 100755
index a0af57c..afd8b2c
--- a/bootable/bootloader/lk/platform/msm8916/gpio.c
+++ b/bootable/bootloader/lk/platform/msm8916/gpio.c
@@ -97,6 +97,16 @@
 				gpio_tlmm_config(7, 3, GPIO_OUTPUT, GPIO_NO_PULL,
 					GPIO_8MA, GPIO_DISABLE);
 			break;
+			case QUP_ID_4:
+				/* configure I2C SDA gpio */
+				gpio_tlmm_config(18, 2, GPIO_OUTPUT, GPIO_NO_PULL,
+						GPIO_8MA, GPIO_DISABLE);
+
+				/* configure I2C SCL gpio */
+				gpio_tlmm_config(19, 2, GPIO_OUTPUT, GPIO_NO_PULL,
+					GPIO_8MA, GPIO_DISABLE);
+				dprintf(CRITICAL, "eliot : gpio_config_blsp_i2c QUP_ID_4 %d\n",qup_id);
+			break;
 			default:
 				dprintf(CRITICAL, "Incorrect QUP id %d\n",qup_id);
 				ASSERT(0);
diff --git a/bootable/bootloader/lk/platform/msm8916/include/platform/iomap.h b/bootable/bootloader/lk/platform/msm8916/include/platform/iomap.h
old mode 100644
new mode 100755
index 4094d66..1df473d
--- a/bootable/bootloader/lk/platform/msm8916/include/platform/iomap.h
+++ b/bootable/bootloader/lk/platform/msm8916/include/platform/iomap.h
@@ -76,6 +76,7 @@
 
 #define CLK_CTL_BASE                0x1800000
 
+
 #define SPMI_BASE                   0x02000000
 #define SPMI_GENI_BASE              (SPMI_BASE + 0xA000)
 #define SPMI_PIC_BASE               (SPMI_BASE +  0x01800000)
@@ -105,6 +106,11 @@
 #define GCC_BLSP1_QUP2_CFG_RCGR     (CLK_CTL_BASE + 0x3018)
 #define GCC_BLSP1_QUP2_CMD_RCGR     (CLK_CTL_BASE + 0x3014)
 
+#define GCC_BLSP1_QUP4_APPS_CBCR    (CLK_CTL_BASE + 0x6020)
+#define GCC_BLSP1_QUP4_CFG_RCGR     (CLK_CTL_BASE + 0x6004)
+#define GCC_BLSP1_QUP4_CMD_RCGR     (CLK_CTL_BASE + 0x6000)
+
+
 /* GPLL */
 #define GPLL0_STATUS                (CLK_CTL_BASE + 0x2101C)
 #define GPLL1_STATUS                (CLK_CTL_BASE + 0x2001C)
diff --git a/bootable/bootloader/lk/platform/msm8916/msm8916-clock.c b/bootable/bootloader/lk/platform/msm8916/msm8916-clock.c
old mode 100644
new mode 100755
index d8cf7bd..ce301b2
--- a/bootable/bootloader/lk/platform/msm8916/msm8916-clock.c
+++ b/bootable/bootloader/lk/platform/msm8916/msm8916-clock.c
@@ -169,6 +169,13 @@
 	F(   50000000,  gpll0,  16,   0,  0),
 	F_END
 };
+/* BLSP1_QUP4 Clocks */
+static struct clk_freq_tbl ftbl_gcc_blsp1_qup4_i2c_apps_clk_src[] = {
+	F(  19200000,	      cxo,   1,	  0,	0),
+	F(  50000000,	   gpll0,  16,	  0,	0),
+	F_END
+};
+
 
 static struct branch_clk gcc_sdcc1_apps_clk =
 {
@@ -562,6 +569,30 @@
 		.ops      = &clk_ops_branch,
 	},
 };
+static struct rcg_clk gcc_blsp1_qup4_i2c_apps_clk_src =
+{
+	.cmd_reg      = (uint32_t *) GCC_BLSP1_QUP4_CMD_RCGR,
+	.cfg_reg      = (uint32_t *) GCC_BLSP1_QUP4_CFG_RCGR,
+	.set_rate     = clock_lib2_rcg_set_rate_hid,
+	.freq_tbl     = ftbl_gcc_blsp1_qup2_i2c_apps_clk_src,
+	.current_freq = &rcg_dummy_freq,
+
+	.c = {
+		.dbg_name = "gcc_blsp1_qup4_i2c_apps_clk_src",
+		.ops      = &clk_ops_rcg,
+	},
+};
+
+static struct branch_clk gcc_blsp1_qup4_i2c_apps_clk = {
+	.cbcr_reg = GCC_BLSP1_QUP4_APPS_CBCR,
+	.parent   = &gcc_blsp1_qup4_i2c_apps_clk_src.c,
+
+	.c = {
+		.dbg_name = "gcc_blsp1_qup4_i2c_apps_clk",
+		.ops      = &clk_ops_branch,
+	},
+};
+
 /* Clock lookup table */
 static struct clk_lookup msm_clocks_8916[] =
 {
@@ -593,6 +624,9 @@
 	CLK_LOOKUP("blsp1_qup2_ahb_iface_clk", gcc_blsp1_ahb_clk.c),
 	CLK_LOOKUP("gcc_blsp1_qup2_i2c_apps_clk_src", gcc_blsp1_qup2_i2c_apps_clk_src.c),
 	CLK_LOOKUP("gcc_blsp1_qup2_i2c_apps_clk", gcc_blsp1_qup2_i2c_apps_clk.c),
+	CLK_LOOKUP("blsp1_qup4_ahb_iface_clk", gcc_blsp1_ahb_clk.c),
+	CLK_LOOKUP("gcc_blsp1_qup4_i2c_apps_clk_src", gcc_blsp1_qup4_i2c_apps_clk_src.c),
+	CLK_LOOKUP("gcc_blsp1_qup4_i2c_apps_clk", gcc_blsp1_qup4_i2c_apps_clk.c),
 };
 
 void msm8939_clock_override()
diff --git a/bootable/bootloader/lk/platform/msm_shared/i2c_qup.c b/bootable/bootloader/lk/platform/msm_shared/i2c_qup.c
old mode 100644
new mode 100755
index 916d865..c554f32
--- a/bootable/bootloader/lk/platform/msm_shared/i2c_qup.c
+++ b/bootable/bootloader/lk/platform/msm_shared/i2c_qup.c
@@ -697,6 +697,7 @@
 
 	/* Register the GSBIn QUP IRQ */
 	register_int_handler(dev->qup_irq, (int_handler) qup_i2c_interrupt, 0);
+	//dprintf(CRITICAL, "eliot:qup_i2c_sec_init irq=%d \n",dev->qup_irq);
 
 	/* Then disable it */
 	mask_interrupt(dev->qup_irq);
@@ -758,7 +759,7 @@
 	/* Platform uses BLSP */
 	dev->qup_irq = BLSP_QUP_IRQ(blsp_id, qup_id);
 	dev->qup_base = BLSP_QUP_BASE(blsp_id, qup_id);
-
+	dprintf(CRITICAL, "eliot:qup_blsp_i2c_init qup_irq = %d,qup_base=0x%x \n",dev->qup_irq,dev->qup_base);	
 	/* This must be done for qup_i2c_interrupt to work. */
 	dev_addr = dev;
 
diff --git a/bootable/bootloader/lk/platform/msm_shared/include/lvds.h b/bootable/bootloader/lk/platform/msm_shared/include/lvds.h
new file mode 100755
index 0000000..753fbc4
--- /dev/null
+++ b/bootable/bootloader/lk/platform/msm_shared/include/lvds.h
@@ -0,0 +1,112 @@
+/*
+eliot shao 2016/11/24
+for icn6202 mipi to lvds bridge
+*/
+
+#include <i2c_qup.h>
+#include <blsp_qup.h>
+
+#include <debug.h>
+#include <err.h>
+#include <mipi_dsi.h>
+#include <boot_stats.h>
+#include <platform/gpio.h>
+#include <msm_panel.h>
+#include <mipi_dsi.h>
+#include <board.h>
+#include <mdp5.h>
+#include <scm.h>
+#include <platform/iomap.h>
+
+static struct qup_i2c_dev  *i2c_dev_6202;
+#define  Slave_addr   0x2D
+
+static int qrd_icn_i2c_read(uint8_t addr)  
+{  
+    int ret = 0; 
+	int val = 0 ;
+    /* Create a i2c_msg buffer, that is used to put the controller into read 
+       mode and then to read some data. */  
+    struct i2c_msg msg_buf[] = {  
+        {Slave_addr, I2C_M_WR, 1, &addr},  
+        {Slave_addr, I2C_M_RD, 1, &val}  
+    };  
+  
+    ret = qup_i2c_xfer(i2c_dev_6202, msg_buf, 2);
+	dprintf(CRITICAL, "eliot qrd_lcd_i2c_read addr = %d, val = 0x%x\n",addr,val);
+    if(ret < 0) {  
+        dprintf(CRITICAL, "qup_i2c_xfer error %d\n", ret);  
+        return ret;  
+    }  
+    return val;  
+}  
+static int qrd_icn_i2c_write(uint8_t addr, uint8_t val)
+{
+	int ret = 0;
+	uint8_t data_buf[] = { addr, val };
+
+	/* Create a i2c_msg buffer, that is used to put the controller into write
+	   mode and then to write some data. */
+	struct i2c_msg msg_buf[] = { {Slave_addr,
+				      I2C_M_WR, 2, data_buf}
+	};
+
+	ret = qup_i2c_xfer(i2c_dev_6202, msg_buf, 1);
+	if(ret < 0) {
+		dprintf(CRITICAL, "eliot qup_i2c_xfer error %d\n", ret);
+		return ret;
+	}
+	return 0;
+}
+
+int RESET_chip()
+{
+	/* configure REST gpio */
+	gpio_tlmm_config(25, 0, GPIO_OUTPUT, GPIO_NO_PULL,
+			GPIO_8MA, 1);//rst
+
+	gpio_set_dir(25,2);
+
+	dprintf(CRITICAL, "eliot:RESET_chip\n");
+	return 0;
+}
+	/*add by eliot shao 2016.11.25*/
+	/*resquest i2c5 and send cmds to icn6202 */
+	/*and how to request an i2c in qcom ? follow it !!*/
+int LVDS_Init()
+{
+	dprintf(CRITICAL, "eliot:LVDS_Init");
+	//int i = 0;
+	RESET_chip();
+
+  	i2c_dev_6202 = qup_blsp_i2c_init(BLSP_ID_1, QUP_ID_4, 100000, 19200000);
+	if(!i2c_dev_6202) {
+ 		 dprintf(CRITICAL, "eliot:qup_blsp_i2c_init failed \n");
+  		return 0;
+	}
+
+	qrd_icn_i2c_read(0);
+	qrd_icn_i2c_write(0x20,0x0);
+	qrd_icn_i2c_write(0x21,0x58);
+	qrd_icn_i2c_write(0x22,0x24);
+	qrd_icn_i2c_write(0x23,0x96);
+	qrd_icn_i2c_write(0x24, 0x14);
+	qrd_icn_i2c_write(0x25, 0x96);
+	qrd_icn_i2c_write(0x26, 0x0);
+	qrd_icn_i2c_write(0x27, 0x0F);
+	qrd_icn_i2c_write(0x28, 0x05);
+	qrd_icn_i2c_write(0x29, 0x0F);
+	qrd_icn_i2c_write(0x34, 0x80);
+	qrd_icn_i2c_write(0x36, 0x96);
+	qrd_icn_i2c_write(0xB5, 0xA0);
+	qrd_icn_i2c_write(0x5C, 0xFF);
+	qrd_icn_i2c_write(0x13, 0x10);
+	qrd_icn_i2c_write(0x56, 0x90);
+	qrd_icn_i2c_write(0x6B, 0x21);
+	qrd_icn_i2c_write(0x69, 0x1C);
+	qrd_icn_i2c_write(0xB6, 0x20);
+	qrd_icn_i2c_write(0x51, 0x20);
+	qrd_icn_i2c_write(0x09, 0x10);		
+	dprintf(CRITICAL, "eliot:icn6202 i2c init OK !!!! \n");
+	
+}
\ No newline at end of file
diff --git a/bootable/bootloader/lk/platform/msm_shared/mipi_dsi.c b/bootable/bootloader/lk/platform/msm_shared/mipi_dsi.c
index 8bd7db8..542ef4c 100755
--- a/bootable/bootloader/lk/platform/msm_shared/mipi_dsi.c
+++ b/bootable/bootloader/lk/platform/msm_shared/mipi_dsi.c
@@ -547,11 +547,11 @@
 			status = mipi_dsi_cmds_tx(pinfo->panel_cmds,
 					pinfo->num_of_panel_cmds);
 			writel(ctrl_mode, MIPI_DSI0_BASE + CTRL);
-
+/*
 			if (!status && target_panel_auto_detect_enabled())
 				status = mdss_dsi_read_panel_signature(pinfo);
 			dprintf(CRITICAL, "Read panel signature status = 0x%x \n", status);
-		}
+		*/}
 	}
 #endif
 	return status;
diff --git a/bootable/bootloader/lk/target/msm8916/include/target/display.h b/bootable/bootloader/lk/target/msm8916/include/target/display.h
index b1bcfa5..140544d 100755
--- a/bootable/bootloader/lk/target/msm8916/include/target/display.h
+++ b/bootable/bootloader/lk/target/msm8916/include/target/display.h
@@ -197,6 +197,7 @@
 	HX8394F_720P_VIDEO_PANEL, //added by shimin 4/19/2016
 	RM68200_720P_VIDEO_PANEL, //mickey.shi, 06/14/2016
 	HX8394F_ZZW500HAH_720P_VIDEO_PANEL, //mickey.shi, 10/17/2016
+	HE070NA_LVDS_600P_VIDEO_PANEL,
 	UNKNOWN_PANEL
 };
 
diff --git a/bootable/bootloader/lk/target/msm8916/oem_panel.c b/bootable/bootloader/lk/target/msm8916/oem_panel.c
index a70a8a5..3e4526f 100755
--- a/bootable/bootloader/lk/target/msm8916/oem_panel.c
+++ b/bootable/bootloader/lk/target/msm8916/oem_panel.c
@@ -61,6 +61,8 @@
 #include "include/panel_otm9605_qhd_video.h"
 #include "include/panel_hx8394f_720p_video.h" //added by shimin, 4/19/2016
 #include "include/panel_hx8394f_zzw500hah_720p_video.h" //mickey.shi, 10/17/2016
+#include "include/panel_he070na_lvds_600p_video.h" //eliot shao 2016/11/24
+
 
 #define DISPLAY_MAX_PANEL_DETECTION 2
 #define OTM8019A_FWVGA_VIDEO_PANEL_ON_DELAY 50
@@ -99,13 +101,14 @@
 	{"hx8389b_qhd_video", HX8389B_QHD_VIDEO_PANEL},
 	{"otm9605_qhd_video", OTM9605_QHD_VIDEO_PANEL},
 	{"hx8394f_720p_video", HX8394F_720P_VIDEO_PANEL}, //added by shimin
-	{"hx8394f_zzw500hah_720p_video", HX8394F_ZZW500HAH_720P_VIDEO_PANEL}, //mickey.shi, 10/17/2016
+	{"hx8394f_zzw500hah_720p_video", HX8394F_ZZW500HAH_720P_VIDEO_PANEL},
+	{"he070na_lvds_600p_video", HE070NA_LVDS_600P_VIDEO_PANEL},
 };
 
 /*add by fangchengbing panel list that can be auto detect*/
 static int skui_supp_panels[] = {
 #if 1
-	HX8394F_ZZW500HAH_720P_VIDEO_PANEL,
+	HE070NA_LVDS_600P_VIDEO_PANEL,
 #else
 	HX8394F_720P_VIDEO_PANEL, 
 #endif
@@ -575,14 +578,13 @@
 		memcpy(phy_db->timing,
 				hx8394f_720p_video_timings, TIMING_SIZE);
 		break;
-
 	case HX8394F_ZZW500HAH_720P_VIDEO_PANEL:
-		panelstruct->paneldata    = &hx8394f_zzw500hah_720p_video_panel_data;
-		panelstruct->panelres     = &hx8394f_zzw500hah_720p_video_panel_res;
-		panelstruct->color        = &hx8394f_zzw500hah_720p_video_color;
+		panelstruct->paneldata	  = &hx8394f_zzw500hah_720p_video_panel_data;
+		panelstruct->panelres	  = &hx8394f_zzw500hah_720p_video_panel_res;
+		panelstruct->color		  = &hx8394f_zzw500hah_720p_video_color;
 		panelstruct->videopanel   = &hx8394f_zzw500hah_720p_video_video_panel;
 		panelstruct->commandpanel = &hx8394f_zzw500hah_720p_video_command_panel;
-		panelstruct->state        = &hx8394f_zzw500hah_720p_video_state;
+		panelstruct->state		  = &hx8394f_zzw500hah_720p_video_state;
 		panelstruct->laneconfig   = &hx8394f_zzw500hah_720p_video_lane_config;
 		panelstruct->paneltiminginfo
 			= &hx8394f_zzw500hah_720p_video_timing_info;
@@ -596,6 +598,26 @@
 				hx8394f_zzw500hah_720p_video_timings, TIMING_SIZE);
 		break;
 
+	case HE070NA_LVDS_600P_VIDEO_PANEL:
+		panelstruct->paneldata    = &he070na_lvds_600p_video_panel_data;
+		panelstruct->panelres     = &he070na_lvds_600p_video_panel_res;
+		panelstruct->color        = &he070na_lvds_600p_video_color;
+		panelstruct->videopanel   = &he070na_lvds_600p_video_video_panel;
+		panelstruct->commandpanel = &he070na_lvds_600p_video_command_panel;
+		panelstruct->state        = &he070na_lvds_600p_video_state;
+		panelstruct->laneconfig   = &he070na_lvds_600p_video_lane_config;
+		panelstruct->paneltiminginfo
+			= &he070na_lvds_600p_video_timing_info;
+		//panelstruct->panelresetseq
+		//	= &he070na_lvds_600p_video_reset_seq;
+		panelstruct->backlightinfo = &he070na_lvds_600p_video_backlight;
+		pinfo->mipi.panel_cmds					= he070na_lvds_600p_video_on_command;
+		pinfo->mipi.num_of_panel_cmds			= HE070NA_LVDS_600P_VIDEO_ON_COMMAND;
+		//pinfo->mipi.get_id = NULL;
+		memcpy(phy_db->timing,
+				he070na_lvds_600p_video_timings, TIMING_SIZE);
+		break;
+		
 	case UNKNOWN_PANEL:
 	default:
 		memset(panelstruct, 0, sizeof(struct panel_struct));
diff --git a/bootable/bootloader/lk/target/msm8916/rules.mk b/bootable/bootloader/lk/target/msm8916/rules.mk
index c7ee1a9..6acddef 100755
--- a/bootable/bootloader/lk/target/msm8916/rules.mk
+++ b/bootable/bootloader/lk/target/msm8916/rules.mk
@@ -11,7 +11,7 @@
 BASE_ADDR        := 0x80000000
 SCRATCH_ADDR     := 0x90000000
 
-DEFINES += DISPLAY_SPLASH_SCREEN=0
+DEFINES += DISPLAY_SPLASH_SCREEN=1
 DEFINES += DISPLAY_TYPE_MIPI=1
 DEFINES += DISPLAY_TYPE_DSI6G=1
 
diff --git a/device/qcom/slm753/system.prop b/device/qcom/slm753/system.prop
index 18cb115..ef3f802 100755
--- a/device/qcom/slm753/system.prop
+++ b/device/qcom/slm753/system.prop
@@ -177,7 +177,7 @@
 persist.radio.detect4gcard=true
 
 #Add by ZhangTing 20161022 for bug 4671
-ro.meig.lcd_density=320
+ro.meig.lcd_density=160
 
 # add by eliot shao 20161108 for lianmai 1024x600 lvds lcm
-ro.sf.lcd_density=240
+ro.sf.lcd_density=160
diff --git a/kernel/arch/arm/boot/dts/qcom/msm8916-qrd-skui-slm753-public.dtsi b/kernel/arch/arm/boot/dts/qcom/msm8916-qrd-skui-slm753-public.dtsi
index 06b4430..87b0daa 100755
--- a/kernel/arch/arm/boot/dts/qcom/msm8916-qrd-skui-slm753-public.dtsi
+++ b/kernel/arch/arm/boot/dts/qcom/msm8916-qrd-skui-slm753-public.dtsi
@@ -163,7 +163,7 @@
        qcom,mdss-dsi-bl-pmic-pwm-frequency = <100>;
        qcom,mdss-dsi-bl-pmic-bank-select = <0>;
        qcom,mdss-dsi-pwm-gpio = <&pm8916_mpps 4 0>;
-       /*qcom,cont-splash-enabled;*/
+       qcom,cont-splash-enabled;
 };
 
 
